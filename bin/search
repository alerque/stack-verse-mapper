#!/usr/bin/env node

var _ = require( 'lodash' );
var search = require( '../src/search.js' );

var site = process.argv[2];
var query = process.argv[3];
var config = require( '../config.json' );
var index = require( '../data/' + site + '-index.json' );

search.search( query, index ).forEach( function( post )
{
	var url = "http://" + site + ".stackexchange.com/" + post.type + "/" + post.id;
	console.log( _.truncate( `${ url } ${ post.type.toUpperCase() }: ${ post.title }`, { length: process.stdout.columns } ) );
	console.log( `  SPEC:${ post.SPEC } (${ _.sortBy( post.refs, 'specificity' )[0].osis }) APS:${ post.APS.toFixed( 2 ) } TDRHP:${ post.TDRHP } TDRHS:${ post.TDRHS } TAG:${ post.TAG } QTH:${ post.QTH } FPS:${ post.FPS.toFixed( 2 ) }` );
});
